-- Copyright (c) 2019, Digital Asset (Switzerland) GmbH and/or its affiliates.
-- All rights reserved.

daml 1.2
module Math where

import DA.Math
import DA.Assert

expTest = scenario do
  let
    e = 2.7182818285
    exp60 = 114200738981568428366295718.3144765630
    exp10 = 22026.4657948067
    expm10 = 0.0000453999
    expm20 = 0.0000000021
    (e35, e35p) = to36dig (e, 0)
  1000000000000000000000000.0 === 1.0 `e10` 24
  1.0 === exp 0.0
  e === e35 `e10` e35p
  e === exp 1.0
  exp10 === exp 10.0
  expm10 === exp (negate 10.0)
  expm20 === exp (negate 20.0)
  assert(abs(exp60 - exp 60.0) < 0.00000001)

logTest = scenario do
  let
    log05 = -0.693147180559
    log15 = 0.405465108108
    log100 = 4.605170185988091
    log10e27 = 62.1697975108392
    log10em9 = -20.723265836946
  0.0 === log 1.0
  log15 === log 1.5
  log05 === log 0.5
  1.0 === log (exp 1.0)
  4.605170186 === log 100.0
  assert(abs(100.0 - exp (log 100.0)) <= 0.000000002)
  log10e27 === log (10.0 ^^ 27)
  log10em9 ===  log (10.0 ^^ (negate 9))
  assert(abs(25.0 - logBase 10.0 (1.0 `e10` 25)) <= 0.0000000001)

powerTest = scenario do
  let
    sqrt2 = 1.4142135623
  assert(abs(sqrt2 - 2.0 ** 0.5) <= 0.0000000001)