# Copyright (c) 2023 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

# Azure Pipelines file, see https://aka.ms/yaml

# Enable builds on all branches
trigger:
  # Build every commit as our release process relies on
  # the release process being built alone.
  batch: false
  branches:
    include:
      - main
      - main-3.x
      - release/*

# Enable PR triggers that target the main branch
pr: none

jobs:
- template: ci/build.yml
  parameters:
    test_mode: main
- template: ci/check-for-release-job.yml

- job: release
  condition: False

- template: ci/split-release-job.yml
- template: ci/refresh-get-daml-com.yml
