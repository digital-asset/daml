# Copyright (c) 2024 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

trigger: none

pr:
  autoCancel: true # cancel previous builds on push
  branches:
    include:
      - main
      - main-2.x
      - release/*

jobs:
  - job: report
    pool:
      name: ubuntu_20_04
      demands: assignment -equals default
    steps:
    - template: bash-lib.yml
      parameters:
        var_name: bash_lib
    - bash: |
        set -euo pipefail

        cd sdk
        eval "$(./dev-env/bin/dade-assist)"
        source $(bash_lib)


        export GH_REPO=digital-asset/daml
        message='[ { "type": "section", "text": { "type": "mrkdwn", "text": "*THIS IS A TEST PLEASE IGNORE*\n\nOpen daml repo PRs to address:" }, "accessory": { "type": "checkboxes", "options": [ { "text": { "type": "mrkdwn", "text": "2024-24-09" }, "description": { "type": "mrkdwn", "text": "<https://google.com|PR title>" } }, { "text": { "type": "mrkdwn", "text": "2024-24-08" }, "description": { "type": "mrkdwn", "text": "<https://google.com|PR title>" } } ] } } ]'
        tell_slack_blocks "$message" "$(Slack.team-sdk-updates)"
      env:
        GITHUB_TOKEN: $(CANTON_READONLY_TOKEN)
