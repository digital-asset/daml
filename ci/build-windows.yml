steps:
  - checkout: self

  - bash: ci/configure-bazel.sh
    displayName: 'Configure Bazel'
    env:
      IS_FORK: variables['System.PullRequest.IsFork']
      # to upload to the bazel cache
      GOOGLE_APPLICATION_CREDENTIALS_CONTENT: $(GOOGLE_APPLICATION_CREDENTIALS_CONTENT)

  - bash: 'cat .bazelrc.local'
    displayName: 'Print .bazelrc.local'

  - powershell: '.\build.ps1 ci'
    displayName: 'Build'
