// Copyright (c) 2023 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
// SPDX-License-Identifier: Apache-2.0

syntax = "proto3";
package daml_lf_dev;

import "com/daml/daml_lf_dev/daml_lf_1.proto";
import "scenario_service.proto";

message TestResults {
  // What was defined
  repeated Template templates = 1;
  repeated Interface interfaces = 2;
  repeated InterfaceInstanceIdentifier interface_instances = 3;

  // What was used
  repeated Created created = 4;
  repeated Exercise exercised = 5;
}

message Template {
  TemplateIdentifier id = 1;
  Choices choices = 2;
}

message Interface {
  InterfaceIdentifier id = 1;
  Choices choices = 2;
}

message Choices {
  repeated string choice = 1;
}

message TemplateIdentifier {
  string qualified_name = 1;
  PackageId package_id = 2;
}

message InterfaceIdentifier {
  string qualified_name = 1;
  PackageId package_id = 2;
}

message InterfaceInstanceIdentifier {
  TemplateIdentifier instance_template = 1;
  InterfaceIdentifier instance_interface = 2;
  PackageId package_id = 3;
}

message Created {
  TemplateIdentifier templateIdentifier = 1;
  repeated PackageId locations = 2;
}

message Exercise {
  string choice = 1;
  repeated ExerciseOnTemplate exercise = 2;
}

message ExerciseOnTemplate {
  TemplateIdentifier template = 1;
  repeated PackageId locations = 2;
}

message PackageId {
  oneof variety {
    Unit local = 1;
    string external = 2;
  }

  string name = 3; // empty for local packages, for now
}
