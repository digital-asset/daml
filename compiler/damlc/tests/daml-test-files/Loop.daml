-- Copyright (c) 2023 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0

-- @ENABLE-SCENARIOS

module Loop where

import Daml.Script

loop : Int -> ()
loop x = loop (x + 1) 

-- @ERROR range=14:1-14:25; Evaluation timed out after 5 seconds
loop_in_scenario_machine = scenario do
  alice <- getParty "p"
  pure $ loop 1
  
template Helper
  with
    p : Party
  where
    signatory p
    choice Go : ()
      controller p
      do
        pure $ loop 1

-- @ERROR range=29:1-29:23; Evaluation timed out after 5 seconds
loop_in_ledger_machine = scenario do
   alice <- getParty "p"
   alice `submit` createAndExercise (Helper alice) Go

-- @ERROR range=34:1-34:15; Evaluation timed out after 5 seconds
loop_in_script = script do
   alice <- allocateParty "p"
   alice `submit` createAndExerciseCmd (Helper alice) Go
