-- Copyright (c) 2020, Digital Asset (Switzerland) GmbH and/or its
-- affiliates. All rights reserved.

-- @WARN range=12:2-12:3; Defined but not used

{-# OPTIONS_GHC -Wunused-matches #-}
module UnusedMatchTests where

-- It should be OK to enable -Wunused-matches and not get warnings
-- from template desugared code.

f x = 12 -- Defined but not used 'x'; prove unsed match detection.

template T
  with
    p : Party
    q : Party
  where
    -- Include interaction with local binds.
    let revokeRetVal = ()
        (sig, obs) = (p, q)
        assertion = True
        plainEnglish = "Chop wood, carry water."
        ident = "123"
    -- None of the below should generate defined but not used
    -- warnings.
    signatory sig
    observer obs
    ensure assertion
    agreement plainEnglish
    key (sig, ident): (Party, Text)
    maintainer key._1
    choice Revoke: () with
      controller p
      do
        pure revokeRetVal
