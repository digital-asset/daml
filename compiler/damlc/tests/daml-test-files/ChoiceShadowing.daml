-- Copyright (c) 2020, Digital Asset (Switzerland) GmbH and/or its affiliates.
-- All rights reserved.

-- Check that name shadowing is allowed in choices, and that the argument takes precedence over the template

module ChoiceShadowing where

template T with
    p : Party
    p2 : Party
  where
    signatory p

    choice Call : ContractId T with
        p : Party
      controller p2
      do
        create T with
          p = p
          p2 = p2

test1 = scenario do
    alice <- getParty "Alice"
    bob <- getParty "Bob"
    cid <- submit p do
      createAndExercise
        (T alice bob)
        (Call bob)
    newT <- queryContractId bob cid
    newT === T bob bob
