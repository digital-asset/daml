-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0

-- @SINCE-LF 1.dev

-- | Test that error (and related primitives) throw a GeneralError.
module ExceptionCatchError where

import Daml.Script
import DA.Assert
import DA.Exception

test1 = script do
    p <- allocateParty "Alice"
    submit p do
        try do
            error "hello"
        catch
            GeneralError msg ->
                msg === "hello"


test2 = script do
    p <- allocateParty "Alice"
    submit p do
        try do
            abort "foo"
        catch
            GeneralError msg ->
                msg === "foo"

test3 = script do
    p <- allocateParty "Alice"
    submit p do
        try do
            fail "bar"
        catch
            GeneralError msg ->
                msg === "bar"
