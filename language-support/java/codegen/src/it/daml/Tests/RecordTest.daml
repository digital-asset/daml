-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0


module Tests.RecordTest where

data MyRecord = MyRecord
  with
    int_: Int
    decimal : Decimal
    text : Text
    bool : Bool
    party : Party
    date : Date
    time : Time
    void : Bool
    list : [()]
    nestedList : [[Int]]
    unit : ()
    nestedRecord: NestedRecord
    nestedVariant: NestedVariant
  deriving (Eq, Show)


data ParametricRecord x y = ParametricRecord
    with
        fieldX1 : x
        fieldX2 : x
        fieldY : y
        fieldInt: Int
  deriving (Eq, Show)

data OuterRecord x y = OuterRecord
    with
        inner : ParametricRecord x y
        innerFixed : ParametricRecord Int Text
  deriving (Eq, Show)

data NestedRecord = NestedRecord
  with
     value: Int
  deriving (Eq, Show)

data NestedVariant = Nested Int
  deriving (Eq, Show)

template Foo
    with
        owner : Party
    where
        signatory owner

data ParametrizedContractId a = ParametrizedContractId
    with
        parametrizedContractId: ContractId a
  deriving (Eq, Show)

data FixedContractId = FixedContractId
    with
        fixedContractId: ParametrizedContractId Foo
  deriving (Eq, Show)

data ClaimF t a x
  = ZeroF
  | OneF a
  | GiveF x
  | AndF with claims: [x]
  | OrF with lhs: x, rhs: x
  | CondF with predicate: (Observation t Bool), success: x, failure: x
  | ScaleF with k: (Observation t Decimal), claim: x
  | WhenF with predicate: (Observation t Bool), claim: x
  | AnytimeF with predicate: (Observation t Bool), zlabel: Text, claim: x
  | UntilF with predicate: (Observation t Bool), zlabel: Text, repeatable: Bool, claim: x
  | LabelF with label: Text, claim: x
  deriving (Eq, Show)

data Observation t a
  = DecimalConst Decimal
  | DecimalObs Text
  | DecimalLte (Observation t Decimal, Observation t Decimal)
  | DecimalEqu (Observation t Decimal, Observation t Decimal)
  | DecimalAdd (Observation t Decimal, Observation t Decimal)
  | DecimalNeg (Observation t Decimal)
  | DecimalMul (Observation t Decimal, Observation t Decimal)
  | DecimalDiv (Observation t Decimal, Observation t Decimal)
  | BoolConst Bool
  | BoolNot (Observation t Bool)
  | BoolAnd (Observation t Bool, Observation t Bool)
  | BoolOr (Observation t Bool, Observation t Bool)
  | DateIdentity
  | DateConst t
  | DateLte (Observation t t, Observation t t)
  | DateEqu (Observation t t, Observation t t)
  deriving (Eq, Show)

-- Not part of the test but the codegen filters out
-- data definitions which are not used in a template
template RecordTestTemplate
    with
        owner : Party
        myRecord : MyRecord
        parametricRecord : ParametricRecord Int Int
        outerRecord : OuterRecord Int Int
        nestedRecord : NestedRecord
        parametrizedContractId : ParametrizedContractId Int
        fixedContractId : FixedContractId
        claimF : ClaimF Int Int Int
    where
        signatory owner
