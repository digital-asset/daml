# Security tests, by category

## Authorization:
- badly-authorized create is rejected: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L77)
- badly-authorized exercise is rejected: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L178)
- badly-authorized exercise/create (create is unauthorized) is rejected: [AuthPropagationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthPropagationSpec.scala#L277)
- badly-authorized exercise/create (exercise is unauthorized) is rejected: [AuthPropagationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthPropagationSpec.scala#L245)
- badly-authorized exercise/exercise (no implicit authority from outer exercise) is rejected: [AuthPropagationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthPropagationSpec.scala#L336)
- badly-authorized fetch is rejected: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L112)
- badly-authorized lookup is rejected: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L135)
- create with no signatories is rejected: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L67)
- create with non-signatory maintainers is rejected: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L89)
- exercise with no controllers is rejected: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L168)
- well-authorized create is accepted: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L60)
- well-authorized exercise is accepted: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L161)
- well-authorized exercise/create is accepted: [AuthPropagationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthPropagationSpec.scala#L223)
- well-authorized exercise/exercise is accepted: [AuthPropagationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthPropagationSpec.scala#L379)
- well-authorized fetch is accepted: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L106)
- well-authorized lookup is accepted: [AuthorizationSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/AuthorizationSpec.scala#L128)

## Confidentiality:
- ensure correct privacy for create node: [BlindingSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/BlindingSpec.scala#L42)
- ensure correct privacy for exercise node (consuming): [BlindingSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/BlindingSpec.scala#L54)
- ensure correct privacy for exercise node (non-consuming): [BlindingSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/BlindingSpec.scala#L75)
- ensure correct privacy for exercise subtree: [BlindingSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/BlindingSpec.scala#L153)
- ensure correct privacy for fetch node: [BlindingSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/BlindingSpec.scala#L97)
- ensure correct privacy for lookup-by-key node (found): [BlindingSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/BlindingSpec.scala#L110)
- ensure correct privacy for lookup-by-key node (not-found): [BlindingSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/BlindingSpec.scala#L131)
- ensure correct privacy for rollback subtree: [BlindingSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/BlindingSpec.scala#L228)

## Integrity:
- Rollback creates cannot be exercise: [EngineTest.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/EngineTest.scala#L2179)
- Smart Contract Upgrade: Can catch different errors thrown by different choice version within Update, using AnyException: [Exceptions.daml](daml-script/test/daml/upgrades/stable/Exceptions.daml#L263)
- Smart Contract Upgrade: Can catch different errors thrown by different choice version, where one is new to V2 within Update, using AnyException: [Exceptions.daml](daml-script/test/daml/upgrades/stable/Exceptions.daml#L267)
- Smart Contract Upgrade: Can catch same errors thrown by different choice versions within Update: [Exceptions.daml](daml-script/test/daml/upgrades/stable/Exceptions.daml#L259)
- Smart Contract Upgrade: Cannot catch DowngradeDropDefinedField upgrade exceptions within Update: [Exceptions.daml](daml-script/test/daml/upgrades/stable/Exceptions.daml#L227)
- Smart Contract Upgrade: Cannot catch ValidationFailed upgrade exceptions within Update: [Exceptions.daml](daml-script/test/daml/upgrades/stable/Exceptions.daml#L216)
- contract key behaviour (non-unique mode): [ContractKeySpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/ContractKeySpec.scala#L438)
- contract key behaviour (unique mode): [ContractKeySpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/ContractKeySpec.scala#L448)
- contract keys must have a non-empty set of maintainers: [ContractKeySpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/ContractKeySpec.scala#L241)
- contract keys should be evaluated after ensure clause: [ContractKeySpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/ContractKeySpec.scala#L208)
- contract keys should be evaluated only when executing create: [ContractKeySpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/ContractKeySpec.scala#L166)
- ensure builtin operators have the correct type: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L72)
- ensure expression forms have the correct type: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L133)
- exercise-by-interface command is rejected for a: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L188)
- ill-formed create API command is rejected: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L176)
- ill-formed create replay command is rejected: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L121)
- ill-formed create-and-exercise API command is rejected: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L201)
- ill-formed exception definitions are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L1656)
- ill-formed exercise API command is rejected: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L181)
- ill-formed exercise replay command is rejected: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L126)
- ill-formed exercise-by-key API command is rejected: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L192)
- ill-formed exercise-by-key replay command is rejected: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L133)
- ill-formed expressions are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L447)
- ill-formed fetch command is rejected: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L181)
- ill-formed fetch-by-key command is rejected: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L184)
- ill-formed interfaces are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L1388)
- ill-formed kinds are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L44)
- ill-formed lookup command is rejected: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L189)
- ill-formed records are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L1805)
- ill-formed templates are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L1033)
- ill-formed type synonyms applications are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L1784)
- ill-formed type synonyms definitions are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L1879)
- ill-formed types are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L125)
- ill-formed variants are rejected: [TypingSpec.scala](canton/community/daml-lf/validation/src/test/scala/com/digitalasset/daml/lf/validation/TypingSpec.scala#L1842)
- well formed create API command is accepted: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L128)
- well formed create replay command is accepted: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L92)
- well formed create-and-exercise API command is accepted: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L156)
- well formed exercise API command is accepted: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L133)
- well formed exercise replay command is accepted: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L97)
- well formed exercise-by-interface command is accepted: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L149)
- well formed exercise-by-key API command is accepted: [ApiCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ApiCommandPreprocessorSpec.scala#L141)
- well formed exercise-by-key command is accepted: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L105)
- well formed fetch replay command is accepted: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L157)
- well formed fetch-by-key replay command is accepted: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L163)
- well formed lookup replay command is accepted: [ReplayCommandPreprocessorSpec.scala](canton/community/daml-lf/engine/src/test/scala/com/digitalasset/daml/lf/engine/preprocessing/ReplayCommandPreprocessorSpec.scala#L168)


