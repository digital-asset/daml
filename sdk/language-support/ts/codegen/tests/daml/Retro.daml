-- Copyright (c) 2024 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0

{-# OPTIONS -Wno-retroactive-interface-instances #-}
-- TODO(https://github.com/digital-asset/daml/issues/18049):
-- Retroactive interface instances will be removed in LF 2.x, after which
-- this test will no longer make sense.

module Retro where

import Main (Asset(..))
import RetroView

interface Retro where
  viewtype RetroView
  getOwner : Party

  nonconsuming choice RetroChoice : (Text, ContractId Retro)
    with
      echo : Text
    controller getOwner this
    do
      pure $ ("invoked RetroChoice with " <> echo, self)

  interface instance Retro for Asset where
    view = RetroView 1
    getOwner = owner

  interface instance Retro for LocalRetro where
    view = RetroView 2
    getOwner = owner

template LocalRetro with
    owner: Party
  where
    signatory owner
