-- Copyright (c) 2025 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0

module ExceptionsDeprecated where

-- @ WARN range=7:1-7:20; DA.Exception; Exceptions are deprecated
import DA.Exception

-- @ WARN range=10:11-10:22; Exceptions are deprecated
exception MyException with
    m : Text
  where
    message m

exprTest : Update ()
exprTest = do
  -- 3 Warnings here, two for the `try-catch` itself, one for the use of `GeneralError` matching.
  -- @ WARN range=21:3-22:33; _tryCatch; Exceptions are deprecated
  -- @ WARN range=22:9-22:33; fromAnyException; Exceptions are deprecated
  -- @ WARN range=22:9-22:21; GeneralError; Exceptions are deprecated
  try pure 1
  catch GeneralError _ -> pure 2

  -- @ WARN range=26:3-26:8; throw; Exceptions are deprecated
  -- @ WARN range=26:11-26:23; GeneralError; Exceptions are deprecated
  throw $ GeneralError "error"

  -- @ WARN range=29:13-29:28; ArithmeticError; Exceptions are deprecated
  let err = ArithmeticError "Can't add!"
  -- @ WARN range=31:16-31:28; AnyException; Exceptions are deprecated
      anyErr : AnyException
      anyErr = error "only care about type"

  pure ()

-- Separate file, test the warnings go away, test other warnings still work
